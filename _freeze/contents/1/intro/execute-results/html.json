{
  "hash": "dfb7419876e802e0196c20ecce928c55",
  "result": {
    "engine": "jupyter",
    "markdown": "# Preliminaries\n\n## Why Python?\n\n### Python is easy to learn and use\n\n\n```{=html}\n<!-- Programmers familiar with traditional languages will find it easy to learn Python. All of the familiar constructs—loops, conditional statements, arrays, and so forth—are included, but many are easier to use in Python. Here are a few of the reasons why:\n\n- Types are associated with objects, not variables. A variable can be assigned a value of any type, and a list can contain objects of many types. This also means that type casting usually isn’t necessary and that your code isn’t locked into the straitjacket of predeclared types.\n\n- Python typically operates at a much higher level of abstraction. This is partly the result of the way the language is built and partly the result of an extensive standard code library that comes with the Python distribution. A program to download a web page can be written in two or three lines!\n\n- Syntax rules are very simple. Although becoming an expert Pythonista takes time\nand effort, even beginners can absorb enough Python syntax to write useful\ncode quickly.\n\nPython is well suited for rapid application development. It isn’t unusual for coding an application in Python to take one-fifth the time it would in C or Java and to take as little as one-fifth the number of lines of the equivalent C program. This depends on the particular application, of course; for a numerical algorithm performing mostly integer arithmetic in for loops, there would be much less of a productivity gain. For the average application, the productivity gain can be significant.  -->\n```\n\n\n\n### Python is easy to read\n\n### Python Community is mature and supportive\n\n\n## Hello world!\n\n\n<!-- \nWe will mainly focus on this code editor mode at the beginning and check our results or do some simple computations in the console.\n\nNotebook is another very popular mode to use Python. We will talk about it later.\n\n -->\n\n\n### Setup the Python environment\n\nIn this section we are going to setup the Python developing environment.\n\n#### VS Code + Anaconda\nClick [Appendix -@sec-vscode] to see the detailed steps for VS Code and conda. You may also check out [the official document](https://code.visualstudio.com/docs/languages/python). It contains more features but less details.\n\nWe will talk about the relation between Python and Anaconda and more about packages sometime later.\n\n#### Google Colab\nClick [Appendix -@sec-googlecolab] for more details.\n\n\n### `Hello World!`\n\n\n<!-- 5. Here are the steps to edit the system environment variables. First in the start menu search for `Edit the system environment variables`. \n\n![](assests/img/20220817235031.png){fig-align=\"center\"}\n\nThen click the `Environment Variables...` button at the right lower corner. \n\n![](assests/img/20220817235002.png){fig-align=\"center\"} \n\nFind the `Path` variable in either the upper window or the lower window. Use which one depends on whether you want to register the variable for the user or for the machine. In this example I add for the user.\n\nFinally double click the variable and add the following path to it. You need to make changes according to your installation. I recommend you to locate your Anaconda installation first to get the path.\n\n![](assests/img/20220817233748.png){fig-align=\"center\"} -->\n\nTake VS Code as an example. In the editor window, type in the code, and run the file in the interactive window.\n\n::: {#5a2bc37d .cell execution_count=1}\n``` {.python .cell-code}\nprint('Hello World!')\n```\n:::\n\n\n![](assests/img/20220817235844.png){fig-align=\"center\"}  \n\nIf you see a small green check mark in the interactive window and also the output `Hello World!`, you are good to go!\n\n### Python code cells and Notebooks\nIn VS Code you can run codes cell by cell. Each cell is separated by the symbol `# %%`. Each cell may contain multiple lines. You may click the small button on top of the cell or use keybindings.\n\n![](assests/img/20220818000531.png){fig-align=\"center\"}  \n\nThis feature actually mimic the notebook. We may start a real Python Notebook file by directly creating a file with extension `.ipynb`. \n\n![](assests/img/20220818000752.png){fig-align=\"center\"}\n\nThe layout is straightforward. \n\n\n\n\n\n### Linters\nA *linter* is a tool to help you improve your code by analyzing your source code looking for problems. Some popular choices for Python includes `Flake8` and `Pylint`. It is highly recommended to use one that is compatible with your IDE which can help you to increase the quality of your codes from the begining.\n\nTo install `Flake8` please go to [its homepage](https://flake8.pycqa.org/en/latest/). It works well with VS Code.\n\n\n\n## Exercises\n\n::: {#exr-}\n## Hello world!\n\nPlease set up a Python developing environment, for both `.py` file and `.ipynb` notebook file, that will be used across the semester. Then print `Hello World!`.\n:::\n\n::: {#exr-}\n## Define a function and play with `time`\n\nPlease play with the following codes in a Jupyter notebook. We haven't talked about any of them right now. Try to guess what they do and write your guess in markdown cells.\n\n::: {#e78659ba .cell execution_count=2}\n``` {.python .cell-code}\nimport time\n\ndef multistr(x, n=2):\n    return x * n\n\nt0 = time.time()\nx = 'Python'\nprint(multistr(x, n=10))\nt1 = time.time()\nprint(\"Time used: \", t1-t0)\n```\n:::\n\n\n:::\n\n::: {#exr-}\n## Fancy Basketball plot\n\nHere is an example of the data analysis. We pull data from a dataset, filter the data according to our needs and plot it to visualize the data. This is just a show case. You are encouraged to play the code, make tweaks and see what would happen. You don't have to turn in anything.\n\nThe data we choose is Stephen Curry's shots data in 2021-2022 regular season. First we need to load the data. The data is obtained from `nba.com` using `nba_api`. To install this package please go to [its PyPI page](https://pypi.org/project/nba-api/).\n\n::: {#34bb5304 .cell execution_count=3}\n``` {.python .cell-code}\nfrom nba_api.stats.static import players\nfrom nba_api.stats.endpoints import shotchartdetail\nplayer_dict = players.get_players()\n```\n:::\n\n\nThe shots data we need is in `shotchartdetail`. However to use it we need to know the id of `Stephen Curry` using the dataset `player_dict`.\n\n::: {#287e5440 .cell execution_count=4}\n``` {.python .cell-code}\nfor player in player_dict:\n    if player['full_name'] == 'Stephen Curry':\n        print(player['id'])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n201939\n```\n:::\n:::\n\n\nSo the id of `Stephen Curry` is `201939`. Let's pull out his shots data in 2021-2022 season.\n\n::: {#026f3473 .cell execution_count=5}\n``` {.python .cell-code}\nresults = shotchartdetail.ShotChartDetail(\n            team_id = 0,\n            player_id = 201939,\n            context_measure_simple = 'FGA',\n            season_nullable = '2021-22',\n            season_type_all_star = 'Regular Season')\ndf = results.get_data_frames()[0]\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>GRID_TYPE</th>\n      <th>GAME_ID</th>\n      <th>GAME_EVENT_ID</th>\n      <th>PLAYER_ID</th>\n      <th>PLAYER_NAME</th>\n      <th>TEAM_ID</th>\n      <th>TEAM_NAME</th>\n      <th>PERIOD</th>\n      <th>MINUTES_REMAINING</th>\n      <th>SECONDS_REMAINING</th>\n      <th>...</th>\n      <th>SHOT_ZONE_AREA</th>\n      <th>SHOT_ZONE_RANGE</th>\n      <th>SHOT_DISTANCE</th>\n      <th>LOC_X</th>\n      <th>LOC_Y</th>\n      <th>SHOT_ATTEMPTED_FLAG</th>\n      <th>SHOT_MADE_FLAG</th>\n      <th>GAME_DATE</th>\n      <th>HTM</th>\n      <th>VTM</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>26</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>10</td>\n      <td>9</td>\n      <td>...</td>\n      <td>Left Side Center(LC)</td>\n      <td>24+ ft.</td>\n      <td>28</td>\n      <td>-109</td>\n      <td>260</td>\n      <td>1</td>\n      <td>0</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>34</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>9</td>\n      <td>41</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>24+ ft.</td>\n      <td>26</td>\n      <td>48</td>\n      <td>257</td>\n      <td>1</td>\n      <td>0</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>37</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>9</td>\n      <td>10</td>\n      <td>...</td>\n      <td>Left Side Center(LC)</td>\n      <td>24+ ft.</td>\n      <td>25</td>\n      <td>-165</td>\n      <td>189</td>\n      <td>1</td>\n      <td>1</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>75</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>6</td>\n      <td>17</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>Less Than 8 ft.</td>\n      <td>1</td>\n      <td>-13</td>\n      <td>12</td>\n      <td>1</td>\n      <td>0</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>130</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>3</td>\n      <td>11</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>Less Than 8 ft.</td>\n      <td>2</td>\n      <td>-15</td>\n      <td>22</td>\n      <td>1</td>\n      <td>0</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 24 columns</p>\n</div>\n```\n:::\n:::\n\n\n`df` is the results we get in terms of a `DataFrame`, and we show the first `5` records as an example.\n\nThese are all attempts. We are interested in all made. By looking at all the columns, we find a column called `SHOT_MADE_FLAG` which shows what we want. Therefore we will use it to filter the records.\n\n::: {#ff50f8bb .cell execution_count=6}\n``` {.python .cell-code}\ndf_made = df[df['SHOT_MADE_FLAG']==1]\ndf_made.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>GRID_TYPE</th>\n      <th>GAME_ID</th>\n      <th>GAME_EVENT_ID</th>\n      <th>PLAYER_ID</th>\n      <th>PLAYER_NAME</th>\n      <th>TEAM_ID</th>\n      <th>TEAM_NAME</th>\n      <th>PERIOD</th>\n      <th>MINUTES_REMAINING</th>\n      <th>SECONDS_REMAINING</th>\n      <th>...</th>\n      <th>SHOT_ZONE_AREA</th>\n      <th>SHOT_ZONE_RANGE</th>\n      <th>SHOT_DISTANCE</th>\n      <th>LOC_X</th>\n      <th>LOC_Y</th>\n      <th>SHOT_ATTEMPTED_FLAG</th>\n      <th>SHOT_MADE_FLAG</th>\n      <th>GAME_DATE</th>\n      <th>HTM</th>\n      <th>VTM</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>37</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>9</td>\n      <td>10</td>\n      <td>...</td>\n      <td>Left Side Center(LC)</td>\n      <td>24+ ft.</td>\n      <td>25</td>\n      <td>-165</td>\n      <td>189</td>\n      <td>1</td>\n      <td>1</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>176</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>1</td>\n      <td>0</td>\n      <td>27</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>Less Than 8 ft.</td>\n      <td>2</td>\n      <td>-7</td>\n      <td>29</td>\n      <td>1</td>\n      <td>1</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>352</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>2</td>\n      <td>1</td>\n      <td>29</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>Less Than 8 ft.</td>\n      <td>1</td>\n      <td>-1</td>\n      <td>10</td>\n      <td>1</td>\n      <td>1</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>510</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>3</td>\n      <td>2</td>\n      <td>23</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>Less Than 8 ft.</td>\n      <td>1</td>\n      <td>7</td>\n      <td>8</td>\n      <td>1</td>\n      <td>1</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Shot Chart Detail</td>\n      <td>0022100002</td>\n      <td>642</td>\n      <td>201939</td>\n      <td>Stephen Curry</td>\n      <td>1610612744</td>\n      <td>Golden State Warriors</td>\n      <td>4</td>\n      <td>5</td>\n      <td>34</td>\n      <td>...</td>\n      <td>Center(C)</td>\n      <td>24+ ft.</td>\n      <td>26</td>\n      <td>48</td>\n      <td>260</td>\n      <td>1</td>\n      <td>1</td>\n      <td>20211019</td>\n      <td>LAL</td>\n      <td>GSW</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 24 columns</p>\n</div>\n```\n:::\n:::\n\n\nWe also notice that there are two columns `LOC_X` and `LOC_Y` shows the coordinates of the attempts. We will use it to draw the heatmap. The full code for drawing out the court `draw_court` is folded below. It is from [Bradley Fay GitHub](https://github.com/bradleyfay/py-Goldsberry/blob/master/docs/Visualizing%20NBA%20Shots%20with%20py-Goldsberry.ipynb).\n\n::: callout-note\nNote that, although `draw_cort` is long, it is not hard to understand. It just draws a court piece by piece.\n:::\n\n::: {#3872b6fb .cell execution_count=7}\n``` {.python .cell-code code-fold=\"true\"}\nfrom matplotlib.patches import Circle, Rectangle, Arc\nimport matplotlib.pyplot as plt\n\n\ndef draw_court(ax=None, color='gray', lw=1, outer_lines=False):\n    \"\"\"\n    Returns an axes with a basketball court drawn onto to it.\n\n    This function draws a court based on the x and y-axis values that the NBA\n    stats API provides for the shot chart data.  For example, the NBA stat API\n    represents the center of the hoop at the (0,0) coordinate.  Twenty-two feet\n    from the left of the center of the hoop in is represented by the (-220,0)\n    coordinates.  So one foot equals +/-10 units on the x and y-axis.\n    \"\"\"\n    if ax is None:\n        ax = plt.gca()\n\n    # Create the various parts of an NBA basketball court\n\n    # Create the basketball hoop\n    hoop = Circle((0, 0), radius=7.5, linewidth=lw, color=color, fill=False)\n\n    # Create backboard\n    backboard = Rectangle((-30, -7.5), 60, -1, linewidth=lw, color=color)\n\n    # The paint\n    # Create the outer box 0f the paint, width=16ft, height=19ft\n    outer_box = Rectangle((-80, -47.5), 160, 190, linewidth=lw, color=color,\n                          fill=False)\n    # Create the inner box of the paint, widt=12ft, height=19ft\n    inner_box = Rectangle((-60, -47.5), 120, 190, linewidth=lw, color=color,\n                          fill=False)\n\n    # Create free throw top arc\n    top_free_throw = Arc((0, 142.5), 120, 120, theta1=0, theta2=180,\n                         linewidth=lw, color=color, fill=False)\n    # Create free throw bottom arc\n    bottom_free_throw = Arc((0, 142.5), 120, 120, theta1=180, theta2=0,\n                            linewidth=lw, color=color, linestyle='dashed')\n    # Restricted Zone, it is an arc with 4ft radius from center of the hoop\n    restricted = Arc((0, 0), 80, 80, theta1=0, theta2=180, linewidth=lw,\n                     color=color)\n\n    # Three point line\n    # Create the right side 3pt lines, it's 14ft long before it arcs\n    corner_three_a = Rectangle((-220, -47.5), 0, 140, linewidth=lw,\n                               color=color)\n    # Create the right side 3pt lines, it's 14ft long before it arcs\n    corner_three_b = Rectangle((220, -47.5), 0, 140, linewidth=lw, color=color)\n    # 3pt arc - center of arc will be the hoop, arc is 23'9\" away from hoop\n    three_arc = Arc((0, 0), 475, 475, theta1=22, theta2=158, linewidth=lw,\n                    color=color)\n\n    # Center Court\n    center_outer_arc = Arc((0, 422.5), 120, 120, theta1=180, theta2=0,\n                           linewidth=lw, color=color)\n    center_inner_arc = Arc((0, 422.5), 40, 40, theta1=180, theta2=0,\n                           linewidth=lw, color=color)\n\n    # List of the court elements to be plotted onto the axes\n    court_elements = [hoop, backboard, outer_box, inner_box, top_free_throw,\n                      bottom_free_throw, restricted, corner_three_a,\n                      corner_three_b, three_arc, center_outer_arc,\n                      center_inner_arc]\n\n    if outer_lines:\n        # Draw the half court line, baseline and side out bound lines\n        outer_lines = Rectangle((-250, -47.5), 500, 470, linewidth=lw,\n                                color=color, fill=False)\n        court_elements.append(outer_lines)\n\n    # Add the court elements onto the axes\n    for element in court_elements:\n        ax.add_patch(element)\n\n    return ax\n```\n:::\n\n\n::: {#253112ed .cell execution_count=8}\n``` {.python .cell-code}\n# Create figure and axes\nfig = plt.figure(figsize=(6, 6))\nax = fig.add_axes([0, 0, 1, 1])\n\n# Plot hexbin of shots\nax.hexbin(df['LOC_X'], df['LOC_Y'], gridsize=(30, 30), extent=(-300, 300, 0, 940), bins='log', cmap='Blues')\nax = draw_court(ax, 'black')\n\n# Annotate player name and season\nax.text(0, 1.05, 'Stephen Curry\\n2021-22 Regular Season', transform=ax.transAxes, ha='left', va='baseline')\n\n# Set axis limits\n_ = ax.set_xlim(-250, 250)\n_ = ax.set_ylim(0, 400)\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_files/figure-html/cell-9-output-1.png){width=630 height=671}\n:::\n:::\n\n\n:::\n\n",
    "supporting": [
      "intro_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}